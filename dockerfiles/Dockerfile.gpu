# syntax=docker/dockerfile:1.0.0-experimental
FROM nvidia/cuda:10.0-cudnn7-runtime-ubuntu18.04

ENV PYTHONPATH=/app LANG=C.UTF-8

ADD ./ /app

WORKDIR /app

RUN --mount=type=secret,id=gitlab_credentials.ini \
	apt-get update && \
	apt-get install -y python3-pip git libgomp1 && \
	python3 setup.py install --gpu && \
	chmod -R o+rx /usr/local/lib/python3.6/dist-packages/ray*
